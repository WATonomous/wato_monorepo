version: "3.8"
services:
  vnc:
    build:
      context: ..
      dockerfile: docker/infrastructure/vis_tools/vnc.Dockerfile
      cache_from:
        - "${INFRASTRUCTURE_VIS_TOOLS_VNC_IMAGE:?}:${TAG}"
        - "${INFRASTRUCTURE_VIS_TOOLS_VNC_IMAGE:?}:main"
    image: "${INFRASTRUCTURE_VIS_TOOLS_VNC_IMAGE:?}:${TAG}"
    user: ${FIXUID:?}:${FIXGID:?}
    ports:
      - "${GUI_TOOLS_VNC_PORT:?}:5900"
    environment:
      - VNC_PORT=${GUI_TOOLS_VNC_PORT:?}
    volumes:
      - rviz_configs:/home/docker/ament_ws/src/simulation_rviz_configs
    runtime: nvidia

volumes:
  rviz_configs:
    driver: local
    driver_opts:
      type: none
      o: bind
      device: ./src/simulation/rviz_configs