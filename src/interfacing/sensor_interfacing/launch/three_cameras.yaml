# Copyright (c) 2025-present WATonomous. All rights reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

launch:
  - arg:
      name: "camera_config_file"
      default: "$(find-pkg-share sensor_interfacing)/config/three_cameras_config.yaml"
      description: "Path to LiDAR configuration file"

  - load_composable_node:
      composable_node:
        # Camera 0
        - package: spinnaker_camera_driver
          plugin: spinnaker_camera_driver::CameraDriver
          name: camera
          namespace: flir_camera_0
          remap:
            - from: '~/control'
              to: '/exposure_control/control'
          parameters:
            - from: $(var camera_config_file)
            - parameter_file: $(find-pkg-share spinnaker_camera_driver)/config/blackfly.yaml
          extra_arguments:
            - name: use_intra_process_comms
              value: true

        # Camera 1
        - package: spinnaker_camera_driver
          plugin: spinnaker_camera_driver::CameraDriver
          name: camera
          namespace: flir_camera_1
          remap:
            - from: '~/control'
              to: '/exposure_control/control'
          parameters:
            - from: $(var camera_config_file)
            - parameter_file: $(find-pkg-share spinnaker_camera_driver)/config/blackfly.yaml
          extra_arguments:
            - name: use_intra_process_comms
              value: true

        # Camera 2
        - package: spinnaker_camera_driver
          plugin: spinnaker_camera_driver::CameraDriver
          name: camera
          namespace: flir_camera_2
          remap:
            - from: '~/control'
              to: '/exposure_control/control'
          parameters:
            - from: $(var camera_config_file)
            - parameter_file: $(find-pkg-share spinnaker_camera_driver)/config/blackfly.yaml
          extra_arguments:
            - name: use_intra_process_comms
              value: true