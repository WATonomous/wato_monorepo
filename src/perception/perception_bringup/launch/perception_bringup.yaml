# Copyright (c) 2025-present WATonomous. All rights reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
---
launch:
  # Patchwork++ Config
  - arg:
      name: patchwork_cloud_topic
      default: /LIDAR_TOP
      description: Input point cloud topic consumed by Patchwork++
  - arg:
      name: patchwork_ground_topic
      default: /ground_cloud
      description: Ground points output topic from Patchwork++
  - arg:
      name: patchwork_non_ground_topic
      default: /non_ground_cloud
      description: Non-ground points output topic from Patchwork++

  # Patchwork++ Node
  - node:
      pkg: wato_patchworkpp
      exec: patchworkpp_node
      name: patchworkpp_node
      output: screen
      param:
        - from: $(find-pkg-share wato_patchworkpp)/config/params.yaml
      remap:
        - from: input_cloud
          to: $(var patchwork_cloud_topic)
        - from: ground_cloud
          to: $(var patchwork_ground_topic)
        - from: non_ground_cloud
          to: $(var patchwork_non_ground_topic)

  # Spatial Association Node
  - node:
      pkg: spatial_association
      exec: spatial_association_node
      name: spatial_association_node
      output: screen
      param:
        - from: $(find-pkg-share spatial_association)/config/params.yaml
        - name: non_ground_cloud_topic
          value: /non_ground_cloud
